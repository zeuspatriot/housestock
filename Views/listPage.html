<template name="listPage">
    <nav class="navbar navbar-default">
        <div class="container-fluid">
            <div class="navbar-header">
                <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1" aria-expanded="false">
                    <span class="sr-only">Toggle navigation</span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                </button>
                <a href="/" class="navbar-brand">HouseStock</a>
            </div>
            <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
                <ul class="nav navbar-nav">
                    <li class="active"><a href="/list/">Shopping list<span class="sr-only">(current)</span></a></li>
                    <li><a href="/stock/">Stock<span class="sr-only">(current)</span></a></li>
                </ul>
            </div>
        </div>
    </nav>
    <!--<h3>Filters:</h3>-->
    <!--{{>filters}}-->

    <h2>Shopping List</h2>
    {{>addListItems}}

    <h4>Add new Product if it is not in select above:</h4>
    {{>addProduct}}
    <div class="grid">
        <h3>Current List:</h3>
        {{>listItems}}
        <div>Total price = {{total}}</div>
    </div>

    <div class="grid">
        <h3>Current Stock:</h3>

            {{#each stockItems}}
                <div>
                    <span>
                        {{#if value.hasWeight}}
                            {{value.weight}} kg
                        {{/if}}
                        {{#unless value.hasWeight}}
                            {{value.amount}}
                        {{/unless}}
                        of {{value.brand}} {{value.name}}{{#if value.units}}, pack of {{value.units}}{{/if}}.
                    </span>
                </div>
            {{/each}}
    </div>



</template>
<template name="addListItems">
    <select name="product" id="productToAdd">
        <option value="none">empty</option>
        {{#each products}}
            <option value="{{_id}}" style="{{#unless like}}background-color: crimson{{/unless}}">{{name}}{{#if units}} x{{units}}{{/if}}</option>
        {{/each}}
    </select>
    <ul>
        <form class="addToList">
            {{#each currProduct}}
                {{#if value}}<li name="{{name}}" value="{{value}}">{{name}}: {{value}}</li>{{/if}}
            {{/each}}

            <input type="number" step="0.001" id="amount" placeholder="How many?" />

            <button type="submit">Add to List</button>
        </form>

    </ul>
</template>

<template name="listItems">
    {{#each items}}
        <div>
            <span id = "{{_id}}">
                {{value.category}}
                {{value.name}} {{#if value.units}}, pack of {{value.units}}{{/if}} of {{value.brand}}
                x
                {{#if value.hasWeight}}
                    {{value.weight}} kg
                {{/if}}
                {{#unless value.hasWeight}}
                    {{value.amount}}
                {{/unless}}
                .
            </span>
            <div>{{#if value.dislikedBrands}}(But not: {{value.dislikedBrands}}){{/if}}</div>
        </div>
        <button class="transferToStock" id="{{value._id}}">to stock</button>
        <button class="remove" id="{{value._id}}">remove</button>

        <div class="popup" id="{{value._id}}">
            <form class="approve">
                <input type="text" name="name" placeholder="product name" title="name" value="{{value.name}}" />
                <input type="number" name="pricePerUnit" min="0" step="0.01" title="Price per Unit" placeholder="price per unit" value="{{value.pricePerUnit}}" />
                <input type="text" name="category" placeholder="product Category" title="Category" value="{{value.category}}" />
                <input type="number" name="units" min="0" step="0.001" title="Units" placeholder="units or weight in kilos" value="{{value.units}}" />
                <input type="date" name="expire" title="Expiry Day" value="{{value.expire}}" />
                <input type="text" name="brand" title="Brand" placeholder="product Brand" value="{{value.brand}}" />
                <input type="text" name="shop" title="Shop" placeholder="Shop product bought in" value="{{value.shop}}" />
                {{#if value.weight}}<input type="number" name="weight" min="0" step="0.001" title="Weight" placeholder="Weight" value="{{value.weight}}" />{{/if}}
                <label for="like">
                    <input type="checkbox" name="like" id="like" title="like" checked="{{value.like}}" />
                    Like this product?
                </label>
                <button class="approve" type="submit">Submit change</button>
            </form>
            <button class="cancel">Cancel</button>
        </div>
    {{/each}}

</template>